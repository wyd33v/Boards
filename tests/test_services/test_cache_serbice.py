#TODO: write tests. mock all redis lib calls
